<!-- public/navbar.html -->
<nav class="bg-blue-500 text-white p-4 flex justify-between">
    <a href="index.html" class="text-lg font-bold">üè† Boarding House</a>
    <div>
        <a href="dashboard.html" class="mx-2">Dashboard</a>
        <a href="booking.html" class="mx-2">Book a Room</a>
        <a href="billing.html" class="mx-2">Billing</a>
        <a href="profile.html" class="mx-2">Profile</a>
        <a href="admin.html" class="mx-2" id="adminLink" style="display: none;">Admin</a>
        <button id="logoutBtn" class="bg-red-500 px-3 py-1 rounded">Logout</button>
    </div>
</nav>

<script type="module">
    import { supabase } from "../db/supabase.js";

    async function checkUser() {
        const { data: { user } } = await supabase.auth.getUser();
        if (!user) {
            window.location.href = "login.html"; // Redirect to login if not logged in
        }

        // Show admin panel if user is an admin
        const { data } = await supabase.from("users").select("role").eq("id", user.id).single();
        if (data.role === "admin") {
            document.getElementById("adminLink").style.display = "inline";
        }
    }

    document.getElementById("logoutBtn")?.addEventListener("click", async () => {
        await supabase.auth.signOut();
        window.location.href = "login.html";
    });

    checkUser();
</script>
